I"­0<hr />

<p id="toc"><strong>Table of Contents</strong></p>
<ul id="markdown-toc">
  <li><a href="#ë„ì»¤-ì»´í¬ì¦ˆ" id="markdown-toc-ë„ì»¤-ì»´í¬ì¦ˆ">ë„ì»¤ ì»´í¬ì¦ˆ</a></li>
  <li><a href="#ì°¸ê³ " id="markdown-toc-ì°¸ê³ ">ì°¸ê³ </a></li>
</ul>

<hr />

<ul>
  <li>java8 ì„¤ì¹˜</li>
  <li>hadoop 3.2.4 ì„¤ì¹˜</li>
  <li>JAVA_HOME, HADOOP_HOME, PATH í™˜ê²½ë³€ìˆ˜ ì„¤ì •
    <ul>
      <li><code class="language-plaintext highlighter-rouge">export JAVA_HOME=/opt/jdk</code></li>
      <li><code class="language-plaintext highlighter-rouge">export HADOOP_HOME=/opt/hadoop</code></li>
      <li><code class="language-plaintext highlighter-rouge">export PATH=${PATH}:/${JAVA_HOME}/bin:${HADOOP_HOME}/bin:${HADOOP_HOME}/sbin</code></li>
    </ul>
  </li>
  <li>ë…¸ë“œ ì¢…ë¥˜ ìƒê´€ ì—†ì´ ê³µí†µ í•­ëª© ì„¤ì •í›„ ziontkim0510/hadoop3.2.4:1.0 ì´ë¯¸ì§€ë¡œ ë¹Œë“œ
    <ul>
      <li>ë…¸ë“œì—ì„œ ì €ì¥í•  ë°ì´í„° ë””ë ‰í„°ë¦¬ ìƒì„±
        <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-p</span> <span class="k">${</span><span class="nv">HADOOP_HOME</span><span class="k">}</span>/data/hdfs/namenode
<span class="nb">mkdir</span> <span class="nt">-p</span> <span class="k">${</span><span class="nv">HADOOP_HOME</span><span class="k">}</span>/data/hdfs/datanode
<span class="nb">mkdir</span> <span class="nt">-p</span> <span class="k">${</span><span class="nv">HADOOP_HOME</span><span class="k">}</span>/data/hdfs/secondarynode
<span class="nb">mkdir</span> <span class="nt">-p</span> <span class="k">${</span><span class="nv">HADOOP_HOME</span><span class="k">}</span>/data/yarn/nm-local-dir
<span class="nb">mkdir</span> <span class="nt">-p</span> <span class="k">${</span><span class="nv">HADOOP_HOME</span><span class="k">}</span>/data/yarn/system/rmstore
</code></pre></div>        </div>
      </li>
      <li><code class="language-plaintext highlighter-rouge">${HADOOP_HOME}/etc/hadoop/hadoop-env.sh</code> íŒŒì¼
        <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">JAVA_HOME</span><span class="o">=</span>/opt/jdk

<span class="nb">export </span><span class="nv">HDFS_NAMENODE_USER</span><span class="o">=</span><span class="s2">"root"</span>
<span class="nb">export </span><span class="nv">HDFS_DATANODE_USER</span><span class="o">=</span><span class="s2">"root"</span>
<span class="nb">export </span><span class="nv">HDFS_SECONDARYNAMENODE_USER</span><span class="o">=</span><span class="s2">"root"</span>
<span class="nb">export </span><span class="nv">YARN_RESOURCEMANAGER_USER</span><span class="o">=</span><span class="s2">"root"</span>
<span class="nb">export </span><span class="nv">YARN_NODEMANAGER_USER</span><span class="o">=</span><span class="s2">"root"</span>

<span class="nb">export </span><span class="nv">HADOOP_LOG_DIR</span><span class="o">=</span>/var/log/hadoop
</code></pre></div>        </div>
      </li>
      <li><code class="language-plaintext highlighter-rouge">${HADOOP_HOME}/etc/hadoop/core-site.xml</code> íŒŒì¼
        <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;</span>

<span class="nt">&lt;configuration&gt;</span>
<span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>fs.defaultFS<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>hdfs://hdfs-name-node:8020<span class="nt">&lt;/value&gt;</span>
<span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div>        </div>
      </li>
      <li><code class="language-plaintext highlighter-rouge">${HADOOP_HOME}/etc/hadoop/hdfs-site.xml</code> íŒŒì¼
        <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;</span>
        
<span class="nt">&lt;configuration&gt;</span>
<span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>dfs.namenode.name.dir<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>file:/opt/hadoop/data/hdfs/namenode<span class="nt">&lt;/value&gt;</span>
<span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>dfs.datanode.data.dir<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>file:/opt/hadoop/data/hdfs/datanode<span class="nt">&lt;/value&gt;</span>
<span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>dfs.namenode.checkpoint.dir<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>file:/opt/hadoop/data/hdfs/secondarynode<span class="nt">&lt;/value&gt;</span>
<span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div>        </div>
      </li>
      <li><code class="language-plaintext highlighter-rouge">${HADOOP_HOME}/etc/hadoop/yarn-site.xml</code> íŒŒì¼
        <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0"?&gt;</span>

<span class="nt">&lt;configuration&gt;</span>

<span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>yarn.nodemanager.aux-services<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>mapreduce_shuffle<span class="nt">&lt;/value&gt;</span>
<span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>yarn.nodemanager.local-dirs<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>/opt/hadoop/data/yarn/nm-local-dir<span class="nt">&lt;/value&gt;</span>
<span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>yarn.resourcemanager.fs.state-store.uri<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>/opt/hadoop/data/yarn/system/rmstore<span class="nt">&lt;/value&gt;</span>
<span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>yarn.resourcemanager.hostname<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>hdfs-name-node<span class="nt">&lt;/value&gt;</span>
<span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>yarn.resourcemanager.address<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>hdfs-name-node:8032<span class="nt">&lt;/value&gt;</span>
<span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>

</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>ë„¤ì„ë…¸ë“œ, ì„¸ì»¨ë”ë¦¬ ë…¸ë“œ ì„¤ì •í›„ ziontkim0510/hadoop-name-3.2.4:1.0, ziontkim0510/hadoop-secondary-3.2.4:1.0 ì´ë¯¸ì§€ë¡œ ë¹Œë“œ
    <ul>
      <li>HDFS íŒŒì¼ ì‹œìŠ¤í…œ í¬ë§·: ë„¤ì„ ë…¸ë“œì—ì„œ <code class="language-plaintext highlighter-rouge">hdfs namenode -format</code> ëª…ë ¹ì–´ ì‹¤í–‰</li>
      <li><code class="language-plaintext highlighter-rouge">${HADOOP_HOME}/etc/hadoop/workers</code> íŒŒì¼ì— ë°ì´í„° ë…¸ë“œ ì¶”ê°€
        <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># workers</span>
hdfs-data-node-1
hdfs-data-node-2
</code></pre></div>        </div>
      </li>
      <li>ssh í‚¤ ìƒì„± í›„ ì„¤ì •: <code class="language-plaintext highlighter-rouge">ssh-keygen -t rsa</code></li>
    </ul>
  </li>
  <li>ë°ì´í„° ë…¸ë“œ ì„¤ì •í›„ ziontkim0510/hadoop-data-3.2.4:1.0 ì´ë¯¸ì§€ë¡œ ë¹Œë“œ
    <ul>
      <li>ë„¤ì„ë…¸ë“œì—ì„œ ìƒì„±í•œ í¼ë¸”ë¦­ í‚¤ ë³µì‚¬ ë¶™ì—¬ë„£ê¸°</li>
    </ul>
  </li>
</ul>

<h1 id="ë„ì»¤-ì»´í¬ì¦ˆ">ë„ì»¤ ì»´í¬ì¦ˆ</h1>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3.2'</span>
<span class="na">services</span><span class="pi">:</span>
  <span class="na">hdfs-name-node</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">ziontkim0510/hadoop-name-3.2.4:1.0</span>
    <span class="na">hostname</span><span class="pi">:</span> <span class="s">hdfs-name-node</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">hdfs-name-node</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">9870:9870</span>
    <span class="na">command</span><span class="pi">:</span> 
      <span class="pi">-</span> <span class="s">bash</span>
      <span class="pi">-</span> <span class="s">-c</span> 
      <span class="pi">-</span> <span class="pi">|</span>
        <span class="s">/etc/init.d/ssh restart &amp;</span>
        <span class="s">./${HADOOP_HOME}/sbin/start-dfs.sh &amp;</span>
        <span class="s">./${HADOOP_HOME}/sbin/start-yarn.sh &amp;</span>
        <span class="s">sleep infinity</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">hdfs-data-node-1</span>
      <span class="pi">-</span> <span class="s">hdfs-data-node-2</span>

  <span class="na">hdfs-secondary-node</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">ziontkim0510/hadoop-secondary-3.2.4:1.0</span>
    <span class="na">hostname</span><span class="pi">:</span> <span class="s">hdfs-secondary-node</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">hdfs-secondary-node</span>
    <span class="na">tty</span><span class="pi">:</span> <span class="no">true</span>

  <span class="na">hdfs-data-node-1</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">ziontkim0510/hadoop-data-3.2.4:1.0</span>
    <span class="na">hostname</span><span class="pi">:</span> <span class="s">hdfs-data-node-1</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">hdfs-data-node-1</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">9860:9864</span>
    <span class="na">command</span><span class="pi">:</span> 
      <span class="pi">-</span> <span class="s">bash</span>
      <span class="pi">-</span> <span class="s">-c</span> 
      <span class="pi">-</span> <span class="pi">|</span>
        <span class="s">/etc/init.d/ssh restart &amp;</span>
        <span class="s">sleep infinity</span>

  <span class="na">hdfs-data-node-2</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">ziontkim0510/hadoop-data-3.2.4:1.0</span>
    <span class="na">hostname</span><span class="pi">:</span> <span class="s">hdfs-data-node-2</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">hdfs-data-node-2</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">9861:9864</span>
    <span class="na">command</span><span class="pi">:</span> 
      <span class="pi">-</span> <span class="s">bash</span>
      <span class="pi">-</span> <span class="s">-c</span> 
      <span class="pi">-</span> <span class="pi">|</span>
        <span class="s">/etc/init.d/ssh restart &amp;</span>
        <span class="s">sleep infinity</span>
</code></pre></div></div>

<p><img src="/images/hdfs_10.png" alt="" /></p>

<h1 id="ì°¸ê³ ">ì°¸ê³ </h1>

<ul>
  <li><a href="https://truman.tistory.com/207#recentComments" target="_blank">Truman Show, ë¦¬ëˆ…ìŠ¤(Linux) - í•˜ë‘¡(Hadoop) ì„¤ì¹˜ ë° í™˜ê²½ ì„¤ì •</a></li>
  <li><a href="https://hoing.io/archives/22174#3" target="_blank">hoing, í•˜ë‘¡ í”„ë¡œê·¸ë˜ë°(3) â€“ ë¹…ë°ì´í„° â€“ í•˜ë‘¡ ì„¤ì¹˜</a></li>
  <li><a href="https://velog.io/@hanovator/Hadoop-%EC%84%A4%EC%B9%98" target="_blank">hanovator, Hadoop ì„¤ì¹˜</a></li>
</ul>
:ET