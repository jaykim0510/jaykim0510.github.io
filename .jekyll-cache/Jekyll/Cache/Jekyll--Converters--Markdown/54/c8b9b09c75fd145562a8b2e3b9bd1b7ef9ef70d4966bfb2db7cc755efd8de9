I"%<hr />

<p id="toc"><strong>Table of Contents</strong></p>
<ul id="markdown-toc">
  <li><a href="#분류classification" id="markdown-toc-분류classification">분류(Classification)</a>    <ul>
      <li><a href="#손실-함수" id="markdown-toc-손실-함수">손실 함수</a></li>
    </ul>
  </li>
</ul>

<hr />

<h1 id="분류classification">분류(Classification)</h1>

<ul>
  <li>분류는 강아지와 고양이와 같은 <strong>이중 분류(Binary classification)</strong> 또는 자동차, 비행기, 배와 같은 <strong>다중 분류(Multi class classification)</strong>로 구분된다</li>
  <li>회귀 모델과 거의 비슷하다. 다른 점은 출력층에 <strong>이중 분류는 시그모이드(sigmoid) 함수</strong>, <strong>다중 분류는 소프트맥스(softmax) 함수</strong>를 사용해, <strong>출력값을 각 클래스가 될 확률로 바꿨다</strong>는 점이다</li>
</ul>

<p><img src="/images/activation.png" alt="" /></p>

<ul>
  <li>보통 은닉층에는 ReLU 함수, 이진 분류의 출력층에는 Sigmoid 함수, 다중 분류의 출력층에는 Softmax 함수를 쓴다</li>
</ul>

<p><img src="/images/activation_2.png" alt="" /></p>

<h2 id="손실-함수">손실 함수</h2>

<ul>
  <li>분류 문제는 출력층이 특정 클래스가 될 확률 값이다</li>
  <li>확률 값을 출력으로 할 때 손실 함수는 어떻게 정의하는게 좋을까?</li>
  <li>
    <p>회귀 문제에서의 MSE 손실함수는, 타겟 값의 확률은 1, 타겟이 아닌 값의 확률은 0으로 동시에 보낼 수 없다</p>
  </li>
  <li>타겟 값(p)이 1일 때 확률(q)를 최대로 하고, 타겟 값이 0일 때 확률을 최소로 하자</li>
  <li>이러한 로직을 의사(Pseudo) 코드로 나타내보면 아래와 같다</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>p: 예측할 값 (ex. 0 또는 1)

if p == 1:
    q 를 최대화
else if p == 0:
    q 를 최소화 (-q를 최대화 -&gt; 1-q를 최대화)
</code></pre></div></div>

<ul>
  <li>이를 하나의 값으로 축약하면 아래와 같다</li>
</ul>

<p><img src="/images/ml_19.png" alt="" /></p>

<ul>
  <li>이 값은 곧 Likelihood를 의미한다</li>
</ul>

<p><img src="/images/ml_20.png" alt="" /></p>

<ul>
  <li>그래서 결국 분류 문제는 최대우도추정(MLE)을 하는 것과 같다</li>
</ul>

<p><img src="/images/ml_21.png" alt="" /></p>

<ul>
  <li>하지만 확률은 0과 1사이의 값이기 때문에 여러 데이터에 대해 최대우도추정을 하기에는 그 값이 계속 작아진다</li>
  <li>또 모델 학습에서 비용 함수(Cost function)은 무엇인가를 최소화하는 것이 일반적이다</li>
  <li>그래서 아래와 같은 과정을 추가한다</li>
</ul>

<p><img src="/images/ml_23.png" alt="" /></p>

<ul>
  <li>위의 파란색을 <strong>음의 Log likelihood</strong> 값이라 하고 이를 <strong>크로스 엔트로피</strong>라고 한다</li>
  <li>결국 비용함수는 크로스 엔트로피이고, <strong>분류문제는 크로스 엔트로피를 최소로 하도록 한다</strong></li>
  <li>이 비용함수에 대한 정규방정식은 없지만, convex function이라서 <strong>경사하강법</strong>을 이용하면 해(모델 파라미터)를 구할 수 있다</li>
</ul>
:ET