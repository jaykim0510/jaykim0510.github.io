I"^,<p id="toc"><strong>Table of Contents</strong></p>
<ul id="markdown-toc">
  <li><a href="#desktop-engine-server-host-daemon" id="markdown-toc-desktop-engine-server-host-daemon">Desktop, Engine, Server, Host, Daemon</a></li>
  <li><a href="#docker-server" id="markdown-toc-docker-server">Docker Server</a>    <ul>
      <li><a href="#docker-daemon" id="markdown-toc-docker-daemon">Docker Daemon</a></li>
      <li><a href="#docker-driver" id="markdown-toc-docker-driver">Docker Driver</a>        <ul>
          <li><a href="#storage-driver" id="markdown-toc-storage-driver">Storage Driver</a></li>
          <li><a href="#network-driver" id="markdown-toc-network-driver">Network Driver</a></li>
          <li><a href="#execdriver" id="markdown-toc-execdriver">Execdriver</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#ì°¸ê³ " id="markdown-toc-ì°¸ê³ ">ì°¸ê³ </a></li>
</ul>

<hr />

<h1 id="desktop-engine-server-host-daemon">Desktop, Engine, Server, Host, Daemon</h1>

<p>ë„ì»¤ë¥¼ ê³µë¶€í•˜ë©´ì„œ Docker Desktop, Engine, Server, Host, Daemonì´ë¼ëŠ” ìš©ì–´ë“¤ì˜ ê´€ê³„ê°€ ì¡°ê¸ˆ í—·ê°ˆë ¸ì—ˆìŠµë‹ˆë‹¤. ì§€ê¸ˆê¹Œì§€ ë°°ì› ë˜ ë‚´ìš©ì„ í† ëŒ€ë¡œ ë‹¤ìŒ ìš©ì–´ë“¤ì„ ì§§ê²Œ ì •ë¦¬í•´ë³¼ê¹Œ í•©ë‹ˆë‹¤.</p>

<p><img src="../../images/docker_13.png" alt="" /></p>

<ul>
  <li>
    <p><strong>Docker Desktop</strong><br />
Mac, Windows í™˜ê²½ì—ì„œì˜ ë„ì»¤ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤. ë„ì»¤ëŠ” ë¦¬ëˆ…ìŠ¤ ê¸°ë°˜ì˜ ìš´ì˜ì²´ì œì—ì„œ ë™ì‘í•˜ëŠ” ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ì§€ë§Œ Docker Desktopì„ í†µí•´ Mac, Windowsì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•´ì¤ë‹ˆë‹¤. ë˜í•œ Docker Engineë¿ ì•„ë‹ˆë¼ Docker Composeë„ ê¸°ë³¸ì ìœ¼ë¡œ í•¨ê»˜ ì„¤ì¹˜ë˜ë©° Kubernetesë„ í´ë¦­ í•œ ë²ˆìœ¼ë¡œ ì„¤ì¹˜ê°€ëŠ¥í•˜ë„ë¡ í•´ì¤ë‹ˆë‹¤.</p>
  </li>
  <li>
    <p><strong>Docker Engine</strong><br />
ì¼ë°˜ì ìœ¼ë¡œ ì €í¬ê°€ ë„ì»¤ë¥¼ ìƒê°í•  ë•Œ ê°€ì§€ê³  ìˆëŠ” ê¸°ëŠ¥ë“¤ì„ ê³§ Docker Engineì´ë¼ê³  í•©ë‹ˆë‹¤. ë‹¤ì‹œ ë§í•´ ë„ì»¤ ì»¨í…Œì´ë„ˆë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ ìš”ì²­í•˜ëŠ” Client, ì‹¤ì œ ì»¨í…Œì´ë„ˆë¥¼ ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ëŠ” Serverë¥¼ í¬í•¨í•˜ëŠ” Client-Server Applicationì„ ë§í•©ë‹ˆë‹¤.</p>
  </li>
  <li>
    <p><strong>Docker Server</strong><br />
Docker Clientë¡œ ë¶€í„° REST API í˜•íƒœë¡œ ìš”ì²­ì„ ë°›ì•˜ì„ ë•Œ ê·¸ ìš”ì²­ì„ í† ëŒ€ë¡œ ì‹¤ì œë¡œ ì»¨í…Œì´ë„ˆë¥¼ ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ëŠ” ë¶€ë¶„ì„ ë§í•©ë‹ˆë‹¤.</p>
  </li>
  <li>
    <p><strong>Docker Host</strong><br />
Docker HostëŠ” Docker Engineì´ ì„¤ì¹˜ëœ ê³³ì„ ë§í•©ë‹ˆë‹¤. ì œ ì»´í“¨í„°ê°€ Linuxê¸°ë°˜ì˜ ìš´ì˜ì²´ì œì˜€ë‹¤ë©´ ì œ ì»´í“¨í„° ìì²´ê°€ Hostê°€ ë˜ì—ˆì„ ê²ƒì´ê³ , ë§Œì•½ í´ë¼ìš°ë“œ í™˜ê²½ì—ì„œ ì„œë²„ë¥¼ í•˜ë‚˜ ë¹Œë ¤ì„œ ê±°ê¸°ì— ë„ì»¤ë¥¼ ì„¤ì¹˜í–ˆë‹¤ë©´ ë¹Œë¦° ì„œë²„ê°€ Hostê°€ ë  ê²ƒì…ë‹ˆë‹¤.</p>

    <p>ì°¸ê³ ë¡œ ì œê°€ ì§€ê¸ˆ ì‚¬ìš©í•˜ê³  ìˆëŠ” í™˜ê²½ì€ Macì…ë‹ˆë‹¤. Macì˜ ìš´ì˜ì²´ì œëŠ” Unix ê³„ì—´ì˜ ìš´ì˜ì²´ì œë¡œ Linuxì™€ëŠ” ì‚¬ìš©í•˜ëŠ” ì»¤ë„ì´ ì•½ê°„ ë‹¬ë¼ì„œ ê²°ë¡ ì ìœ¼ë¡œ ë„ì»¤ë¥¼ ë‹¤ì´ë ‰íŠ¸ë¡œ ì„¤ì¹˜í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ macOS ìœ„ì— Linux Virtual Machineì„ í•˜ë‚˜ ë” ë„ìš°ê³  ê·¸ ìœ„ì—ì„œ ë„ì»¤ë¥¼ ì„¤ì¹˜ ì‚¬ìš©í•˜ê²Œ ë©ë‹ˆë‹¤. ì´ë ‡ê²Œ ì‚¬ìš©í•˜ë©´ ê¸°ë³¸ì ìœ¼ë¡œ Linux VMì— 2GB ì •ë„ì˜ ë©”ëª¨ë¦¬ê°€ ì‚¬ìš©ëœë‹¤ê³  í•©ë‹ˆë‹¤.<br />
  <a href="https://www.reddit.com/r/docker/comments/rhorhs/how_much_overhead_from_running_docker_on_a_mac/">(ì°¸ê³ : How much overhead from running Docker on a Mac?)</a></p>
  </li>
  <li>
    <p><strong>Docer Daemon</strong><br />
Docker Daemonì€ Docker Server ì•ˆì— ìˆëŠ” í•µì‹¬ ìš”ì†Œ ì¤‘ í•˜ë‚˜ë¡œ í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° API ìš”ì²­ì„ ìˆ˜ì‹ í•˜ê³  Image, Container, Network ë° Volumeê³¼ ê°™ì€ Docker Objectë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
  </li>
</ul>

<p>ì§€ê¸ˆê¹Œì§€ ë„ì»¤ì˜ í° ê·¸ë¦¼ì—ì„œì˜ êµ¬ì„±ìš”ì†Œì— ëŒ€í•´ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤. ì§€ê¸ˆë¶€í„°ëŠ” ê·¸ ì¤‘ Docker Serverì˜ ë‚´ë¶€ì— ëŒ€í•´ì„œ ì¡°ê¸ˆ ë” ì‚´í´ë³´ë ¤ê³  í•©ë‹ˆë‹¤. ìœ„ì˜ ê·¸ë¦¼ì„ ë³´ë©´ Docker Clientê°€ ìš”ì²­ì„ í•˜ë©´ ë‚˜ë¨¸ì§€ëŠ” Docker Serverì—ì„œ ì‹¤í–‰ì´ ì´ë£¨ì–´ì§€ëŠ”ë° Docker Serverê°€ ìš”ì²­ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ ë‚´ë¶€ì ìœ¼ë¡œ ì–´ë–¤ ê³¼ì •ì„ ê±°ì¹˜ëŠ”ì§€ í•œ ë²ˆ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.</p>

<h1 id="docker-server">Docker Server</h1>
<p>ì•„ë˜ ê·¸ë¦¼ì€ Docker Serverì˜ ì•„í‚¤í…ì²˜ë¥¼ ë³´ì—¬ì£¼ëŠ” ì¢‹ì€ ê·¸ë¦¼ì…ë‹ˆë‹¤. ë¹„ë¡ 2014ë…„ë„ì— ê·¸ë ¤ì§„ ê·¸ë¦¼ì´ì–´ì„œ ìµœê·¼ ë²„ì „ì˜ ë„ì»¤ì™€ëŠ” ì°¨ì´ê°€ ìˆì„ ìˆ˜ ìˆì§€ë§Œ ë„ì»¤ì˜ ê¸°ë³¸ êµ¬ì„±ìš”ì†Œë¥¼ ê³µë¶€í•˜ëŠ” ë°ì—ëŠ” ì¢‹ì€ ìë£Œë¼ê³  ìƒê°í•©ë‹ˆë‹¤.</p>

<p>í¬ê²Œ ë‘ ê°œì˜ ì‚¬ê°í˜• ë©ì–´ë¦¬ê°€ ê°ê° Docker Daemonê³¼ Docker Driverì…ë‹ˆë‹¤.(<del>ê°œì¸ì ìœ¼ë¡œ Engineì´ë¼ê³  ì íŒ ë¶€ë¶„ì€ ë§ˆì¹˜ ì—”ì§„ê³¼ ê°™ì€ ì—­í• ì„ í•œë‹¤ëŠ” ëœ»ì¼ ë¿ ì €í¬ê°€ ìœ„ì—ì„œ ë°°ìš´ Docker Engineì„ ëœ»í•˜ëŠ” ê±´ ì•„ë‹ˆë¼ê³  ìƒê°í•©ë‹ˆë‹¤.</del>)</p>

<p><img src="../../images/docker_14.jpeg" alt="" /></p>

<h2 id="docker-daemon">Docker Daemon</h2>
<p>Docker daemon ì€ docker engine ë‚´ì—ì„œ ì£¼ë¡œ client ë° registry, driver ì˜ ì¤‘ì‹¬ì—ì„œ ì‘ì—…ì˜ ë¶„ë°°ë¥¼ ë‹´ë‹¹í•˜ëŠ” ì¤‘ì‹¬ì ì´ë¼ê³  ë³´ë©´ ë©ë‹ˆë‹¤. client ë¡œë¶€í„°ì˜ HTTP ìš”ì²­ì„ ë‚´ë¶€ job ë‹¨ìœ„(ê°€ì¥ ê¸°ë³¸ì ì¸ ì‘ì—… ì‹¤í–‰ ë‹¨ìœ„)ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ ë¶„ë°°í•©ë‹ˆë‹¤. ì¦‰, HTTP server ì˜ ì—­í• ê³¼ í•¨ê»˜ client ìš”ì²­ì„ ë¶„ë°°(route and distribute), scheduling í•˜ê³ , ìš”ì²­ì— ëŒ€í•œ ì í•©í•œ Handler ë¥¼ ì°¾ìŠµë‹ˆë‹¤. ìš”ì²­ì— ëŒ€í•´ ì‹¤ì§ˆì ì¸ ì²˜ë¦¬ëŠ” Handler ë¥¼ í†µí•´ ë‹¤ë¥¸ ëª¨ë“ˆ ë“¤ì—ê²Œ ì „ë‹¬í•˜ì—¬ ìˆ˜í–‰í•˜ê³  ê·¸ ê²°ê³¼ë¥¼ ì‘ë‹µìœ¼ë¡œ ì‘ì„±í•˜ì—¬ client ì—ê²Œ ì œê³µí•©ë‹ˆë‹¤.</p>

<h2 id="docker-driver">Docker Driver</h2>
<p>Docker Driver ëŠ” í¬ê²Œ ì„¸ ê°€ì§€ ë²”ì£¼ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<ul>
  <li><strong>graphdriver</strong> : container image ê´€ë¦¬</li>
  <li><strong>networkdriver</strong> : ê°€ìƒ bridge ë“± container ì˜ network ê´€ë¦¬</li>
  <li><strong>execdriver</strong> : container ìƒì„± ê´€ë¦¬</li>
</ul>

<h3 id="storage-driver">Storage Driver</h3>
<p>graphdriverëŠ” Storage Driver ë¼ê³  ì´í•´í•˜ë©´ ë©ë‹ˆë‹¤. <code class="language-plaintext highlighter-rouge">/var/lib/docker</code> ë‚´ì— ì €ì¥ë˜ì–´ ìˆëŠ” container, image ê´€ë ¨ ì •ë³´ë“¤ì„ ì´ìš©í•˜ì—¬ ì‚¬ìš©ìì—ê²Œ í†µí•©ëœ File Systemìœ¼ë¡œ ì œê³µí•˜ëŠ” ë“œë¼ì´ë²„ì…ë‹ˆë‹¤. built-in graphdriver ë¡œëŠ” <code class="language-plaintext highlighter-rouge">btrfs</code>, <code class="language-plaintext highlighter-rouge">vfs</code>, <code class="language-plaintext highlighter-rouge">auts</code>, <code class="language-plaintext highlighter-rouge">devmapper</code>, <code class="language-plaintext highlighter-rouge">overlay2</code> ë“±ì´ ìˆìŠµë‹ˆë‹¤. Storage Driverì— ê´€í•œ ë‚´ìš©ì€ <a href="https://jaykim0510.github.io/docker-series6"><strong>ì´ í¬ìŠ¤íŠ¸</strong></a>ë¥¼ ì°¸ê³ í•˜ì‹œë©´ ë©ë‹ˆë‹¤.</p>

<h3 id="network-driver">Network Driver</h3>
<p>ë„ì»¤ì˜ ë„¤íŠ¸ì›Œí¬ì˜ ì² í•™ì€ <strong>CNM(Container Network Model)</strong>ì„ ë”°ë¦…ë‹ˆë‹¤. CNM ì€ ì»¨í…Œì´ë„ˆë¥¼ ì‚¬ìš©í•˜ëŠ” í™˜ê²½ì—ì„œ ì‚¬ìš©ìê°€ ë„¤íŠ¸ì›Œí¬ ì„¤ê³„ë¥¼ ì‰½ê²Œ í•˜ê¸° ìœ„í•œ ê²ƒì…ë‹ˆë‹¤. ë‹¤ì‹œ ë§í•´, ë³µì¡í•œ ë¬¼ë¦¬ì ì¸ í™˜ê²½ì„ ê³ ë ¤í•  í•„ìš”ì—†ì´ ì‚¬ìš©ìëŠ” ë„¤íŠ¸ì›Œí¬ë¥¼ ì„¤ê³„í•  ë•Œ ì¶”ìƒì ì¸ ê°œë… ë§Œì„ ì´ìš©í•´ ì„¤ê³„í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì¶”ìƒí™”ëŠ” ìš´ì˜ì²´ì œë‚˜ ì¸í”„ë¼ í™˜ê²½ì— êµ¬ì• ë°›ì§€ ì•ŠëŠ” ì„¤ê³„ë¥¼ ê°€ëŠ¥í•˜ë„ë¡ í•´ì¤ë‹ˆë‹¤. CNMì„ êµ¬ì„±í•˜ëŠ” ìš”ì†ŒëŠ” í¬ê²Œ ë‹¤ìŒê³¼ ê°™ì´ 3ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.</p>

<p><img src="../../images/docker_15.png" alt="" /></p>

<ul>
  <li><strong>Sandbox</strong>: ì»¨í…Œì´ë„ˆì˜ Networkì˜ ë§ì€ Endpointë¥¼ ì„¤ì •í•˜ëŠ” ê³³ìœ¼ë¡œ Linux network namespaceì™€ ë¹„ìŠ·í•œ ê°œë…ìœ¼ë¡œ êµ¬í˜„</li>
  <li><strong>Endpoint</strong>: ì»¨í…Œì´ë„ˆ ë‚´ì˜ eth ì™€ ì™¸ë¶€ì˜ vthì˜ í˜ì–´</li>
  <li><strong>Network</strong>: ë„¤íŠ¸ì›Œí¬ëŠ” ì§ì ‘ì ìœ¼ë¡œ í†µì‹ ì„ í•  ìˆ˜ ìˆëŠ” ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì—°ê²°í•˜ëŠ” ì—­í• </li>
</ul>

<p>2ê°œì˜ Sandbox ì•ˆì— ê°ê° Endpoint ìš”ì†Œë¥¼ í•˜ë‚˜ ì”© ë§Œë“¤ê³ , ê·¸ Endpoint ë‘˜ì„ Network ì´ë¼ëŠ” ìš”ì†Œì— ì—°ê²°í•´ ì»¨í…Œì´ë„ˆ ê°„ì˜ í†µì‹ ì„ ìœ„í•œ ë„¤íŠ¸ì›Œí¬ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. <strong>ì´ëŸ¬í•œ ê°œë…(CNM)ìœ¼ë¡œ ë„¤íŠ¸ì›Œí¬ë¥¼ êµ¬í˜„í•´ ë†“ì€ ê²ƒì´ libnetworkì´ê³  ì‚¬ìš©ìê°€ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ë“œë¼ì´ë²„ê°€ Networkdriver ì…ë‹ˆë‹¤.</strong></p>

<p><img src="../../images/docker_21.png" alt="" /></p>

<p>Libnetwork provides the network control and management plane (native service discovery and load balancing). It accepts different drivers to provide the data plane (connectivity and isolation).</p>

<p>Some of the network drivers that we can choose are:</p>

<ul>
  <li><strong>bridge</strong>: it creates single-host bridge networks. Containers connect to these bridges. To allow outbound traffic to the container, the Kernel iptables does NAT. For inbound traffic, we would need to port-forward a host port with a container port.</li>
</ul>

<p>ğŸ¦Š <strong>Note</strong><br />
Every Docker host has a default bridge network (docker0). All new container will attach to it unless you override it (using â€“network flag).</p>

<ul>
  <li><strong>MACVLAN</strong>: Multi-host network. Containers will have its own MAC and IP addresses on the existing physical network (or VLAN). Good things: it is easy and does not use port-mapping. Bad side: the host NIC has to be in promiscuous mode (most cloud provider does not allow this).</li>
  <li><strong>Overlay</strong>: it allows containers in different hosts to communicate using encapsulation. It allows you to create a flat, secure, layer-2 network.</li>
</ul>

<p>Note: Docker creates an Embedded DNS server in user-defined networks. All new containers are registered with the embedded Docker DNS resolver so can resolve names of all other containers in the same network.</p>

<h3 id="execdriver">Execdriver</h3>
<p>ExecdriverëŠ” ì»¨í…Œì´ë„ˆ ìƒì„± ë° ê´€ë¦¬ì— ê´€í•œ ì—­í• ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤. ì¦‰, ì»¤ë„ì˜ ê²©ë¦¬ ê¸°ìˆ ì„ ì´ìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆë¥¼ ìƒì„±í•˜ê³  ì‹¤í–‰í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤. Execdriverì˜ í•˜ìœ„ ë“œë¼ì´ë²„ì¸ Runtime driverë¡œëŠ” ì˜ˆì „ì—ëŠ” ë¦¬ëˆ…ìŠ¤ì˜ <code class="language-plaintext highlighter-rouge">LXC</code>ë¥¼ ì´ìš©í–ˆì§€ë§Œ ìµœê·¼ë²„ì „ì˜ ë„ì»¤ëŠ” ë„ì»¤ë‚´ì—ì„œ ê°œë°œí•œ Docker native runtime driverì¸ <code class="language-plaintext highlighter-rouge">libcontainer</code>ë‚˜ <code class="language-plaintext highlighter-rouge">runc</code>ë¥¼ ì´ìš©í•©ë‹ˆë‹¤.</p>

<p>Execdriverì—ì„œ ì„ íƒëœ LXC ë˜ëŠ” native driverëŠ” Linux Kernel ì—ì„œ ì œê³µí•˜ëŠ” cgroups, namespace ë“±ì˜ ê¸°ëŠ¥ì„ ì´ìš©í•  ìˆ˜ ìˆëŠ” interfaceë¥¼ ì œê³µí•˜ê³ , ì´ë¥¼ í†µí•´ ë„ì»¤ëŠ” ì»¨í…Œì´ë„ˆ ìƒì„± ë° ê´€ë¦¬ì— í•„ìš”í•œ ì‹¤ì§ˆì ì¸ ê¸°ëŠ¥ë“¤ì„ ì œê³µí•©ë‹ˆë‹¤.
docker run ì„ ì‹¤í–‰í•˜ë©´ ì´ëŠ” ê²°êµ­ execdriver -&gt; runtime driver -&gt; cgroups, namespace ë“±ì˜ ê¸°ëŠ¥ì„ ì´ìš©í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ì— ì˜í•´ container í™˜ê²½ì´ ë§ˆë ¨ë˜ê³  ê¸°ë™ë˜ëŠ” ê²ƒì´ë‹¤.</p>

<p><img src="../../images/docker_16.png" alt="" /></p>

<h1 id="ì°¸ê³ ">ì°¸ê³ </h1>
<ul>
  <li><a href="http://cloudrain21.com/examination-of-docker-total-architecture" target="_blank">Rain.ië‹˜ì˜ ë„ì»¤ ì»¨í…Œì´ë„ˆ ê¹Œë³´ê¸°(4) â€“ Docker Total Architecture í¬ìŠ¤íŠ¸</a></li>
  <li><a href="https://medium.com/hacking-talent/docker-all-you-need-to-know-containers-part-2-31120eeb296f" target="_blank">Maria Valcam, Docker: All you need to know â€” Containers Part 2</a></li>
</ul>
:ET