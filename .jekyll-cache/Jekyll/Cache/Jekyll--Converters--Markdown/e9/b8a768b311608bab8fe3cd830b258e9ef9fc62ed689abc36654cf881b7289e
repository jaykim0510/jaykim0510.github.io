I"õ&<hr />

<p id="toc"><strong>Table of Contents</strong></p>
<ul id="markdown-toc">
  <li><a href="#pyflink" id="markdown-toc-pyflink">PyFlink</a></li>
  <li><a href="#datastream-api" id="markdown-toc-datastream-api">DataStream API</a>    <ul>
      <li><a href="#datastream-api-ë§›ë³´ê¸°" id="markdown-toc-datastream-api-ë§›ë³´ê¸°">DataStream API ë§›ë³´ê¸°</a></li>
    </ul>
  </li>
  <li><a href="#table-api" id="markdown-toc-table-api">Table API</a></li>
  <li><a href="#ì°¸ê³ " id="markdown-toc-ì°¸ê³ ">ì°¸ê³ </a></li>
</ul>

<hr />

<h1 id="pyflink">PyFlink</h1>

<p><img src="/images/flink_30.png" alt="" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip install apache-flink
</code></pre></div></div>

<ul>
  <li>PyFlinkëŠ” <strong>ì‹¤ì‹œê°„ ë°ì´í„° ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ”ë° í•„ìš”í•œ ê³ ìˆ˜ì¤€ APIë¥¼ ì œê³µ</strong></li>
  <li>í¬ê²Œ ë‘ ê°€ì§€ì˜ <strong>Table API, DataStream API</strong>ë¥¼ ì œê³µ</li>
  <li>
    <p>ì œê³µë°›ì€ APIë¥¼ ì´ìš©í•´ ì‹¤ì‹œê°„ ë°ì´í„° ì²˜ë¦¬ë¥¼ ìœ„í•œ ìŠ¤í¬ë¦½íŠ¸ë¥¼ <strong>íŒŒì´ì¬</strong> ì–¸ì–´ë¡œ ì‘ì„±í•  ìˆ˜ ìˆìŒ</p>
  </li>
  <li>Table APIëŠ” SQLê³¼ ìœ ì‚¬í•œ í˜•íƒœì˜ ê°•ë ¥í•œ ê´€ê³„í˜• ì¿¼ë¦¬ë¥¼ ì‘ì„±í•˜ëŠ”ë° í•„ìš”í•œ ê¸°ëŠ¥ì„ ì œê³µ</li>
</ul>

<h1 id="datastream-api">DataStream API</h1>

<ul>
  <li>DataStream APIëŠ” ì‹œê°„, ìƒíƒœì™€ ê°™ì€ ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬ì˜ í•µì‹¬ì´ ë˜ëŠ” ê°œë…ë“¤ì„ ë‹¤ë£¨ëŠ”ë° í•„ìš”í•œ ê¸°ëŠ¥ì„ ì œê³µ</li>
  <li><strong>Filtering, Update state, Defining window, Aggregating</strong>ê³¼ ê°™ì€ ìŠ¤íŠ¸ë¦¼ ë°ì´í„° ë³€í™˜ ê¸°ëŠ¥ì„ ì œê³µ</li>
</ul>

<h2 id="datastream-api-ë§›ë³´ê¸°">DataStream API ë§›ë³´ê¸°</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># DataStream API ê´€ë ¨ íŒ¨í‚¤ì§€ ì„í¬íŠ¸í•˜ê¸°
</span>
<span class="kn">from</span> <span class="nn">pyflink.common</span> <span class="kn">import</span> <span class="n">WatermarkStrategy</span><span class="p">,</span> <span class="n">Encoder</span><span class="p">,</span> <span class="n">Types</span>
<span class="kn">from</span> <span class="nn">pyflink.datastream</span> <span class="kn">import</span> <span class="n">StreamExecutionEnvironment</span><span class="p">,</span> <span class="n">RuntimeExecutionMode</span>
<span class="kn">from</span> <span class="nn">pyflink.datastream.connectors</span> <span class="kn">import</span> <span class="p">(</span><span class="n">FileSource</span><span class="p">,</span> <span class="n">StreamFormat</span><span class="p">,</span> <span class="n">FileSink</span><span class="p">,</span> <span class="n">OutputFileConfig</span><span class="p">,</span> <span class="n">RollingPolicy</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ìŠ¤íŠ¸ë¦¬ë° í”„ë¡œê·¸ë¨ì´ ì‹¤í–‰ë˜ëŠ” ì‹¤í–‰í™˜ê²½
# ì‘ì—…ì˜ íŠ¹ì„±ì„ ì„¤ì •
# ì†ŒìŠ¤ ìƒì„±
# ì‘ì—…ì˜ ì‹¤í–‰ íŠ¸ë¦¬ê±°
</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">StreamExecutionEnvironment</span><span class="p">.</span><span class="n">get_execution_environment</span><span class="p">()</span>
<span class="n">env</span><span class="p">.</span><span class="n">set_runtime_mode</span><span class="p">(</span><span class="n">RuntimeExecutionMode</span><span class="p">.</span><span class="n">BATCH</span><span class="p">)</span>
<span class="n">env</span><span class="p">.</span><span class="n">set_parallelism</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># envë¥¼ ì´ìš©í•´ì„œ ì†ŒìŠ¤ ìƒì„±
# ì†ŒìŠ¤ëŠ” ì™¸ë¶€ì‹œìŠ¤í…œì—ì„œ ë°ì´í„° ê°€ì ¸ì˜´
</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">env</span><span class="p">.</span><span class="n">from_source</span><span class="p">(</span>
    <span class="n">source</span><span class="o">=</span><span class="n">FileSource</span><span class="p">.</span><span class="n">for_record_stream_format</span><span class="p">(</span><span class="n">StreamFormat</span><span class="p">.</span><span class="n">text_line_format</span><span class="p">(),</span>
                                               <span class="n">input_path</span><span class="p">)</span>
                     <span class="p">.</span><span class="n">process_static_file_set</span><span class="p">().</span><span class="n">build</span><span class="p">(),</span>
    <span class="n">watermark_strategy</span><span class="o">=</span><span class="n">WatermarkStrategy</span><span class="p">.</span><span class="n">for_monotonous_timestamps</span><span class="p">(),</span>
    <span class="n">source_name</span><span class="o">=</span><span class="s">"file_source"</span>
<span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ë°ì´í„° ë³€í™˜
# ì‹±í¬ì— ë°ì´í„° ì“°ê¸°
</span>
<span class="n">ds</span><span class="p">.</span><span class="n">sink_to</span><span class="p">(</span>
    <span class="n">sink</span><span class="o">=</span><span class="n">FileSink</span><span class="p">.</span><span class="n">for_row_format</span><span class="p">(</span>
        <span class="n">base_path</span><span class="o">=</span><span class="n">output_path</span><span class="p">,</span>
        <span class="n">encoder</span><span class="o">=</span><span class="n">Encoder</span><span class="p">.</span><span class="n">simple_string_encoder</span><span class="p">())</span>
    <span class="p">.</span><span class="n">with_output_file_config</span><span class="p">(</span>
        <span class="n">OutputFileConfig</span><span class="p">.</span><span class="n">builder</span><span class="p">()</span>
        <span class="p">.</span><span class="n">with_part_prefix</span><span class="p">(</span><span class="s">"prefix"</span><span class="p">)</span>
        <span class="p">.</span><span class="n">with_part_suffix</span><span class="p">(</span><span class="s">".ext"</span><span class="p">)</span>
        <span class="p">.</span><span class="n">build</span><span class="p">())</span>
    <span class="p">.</span><span class="n">with_rolling_policy</span><span class="p">(</span><span class="n">RollingPolicy</span><span class="p">.</span><span class="n">default_rolling_policy</span><span class="p">())</span>
    <span class="p">.</span><span class="n">build</span><span class="p">()</span>
<span class="p">)</span>

<span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
    <span class="k">yield</span> <span class="k">from</span> <span class="n">line</span><span class="p">.</span><span class="n">split</span><span class="p">()</span>


<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="p">.</span><span class="n">flat_map</span><span class="p">(</span><span class="n">split</span><span class="p">)</span> \
       <span class="p">.</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">output_type</span><span class="o">=</span><span class="n">Types</span><span class="p">.</span><span class="n">TUPLE</span><span class="p">([</span><span class="n">Types</span><span class="p">.</span><span class="n">STRING</span><span class="p">(),</span> <span class="n">Types</span><span class="p">.</span><span class="n">INT</span><span class="p">()]))</span> \
       <span class="p">.</span><span class="n">key_by</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> \
       <span class="p">.</span><span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ìŠ¤íŠ¸ë¦¼ ì‘ì—… ì‹¤í–‰
# í”Œë§í¬ëŠ” lazy operation -&gt; MapReduceì—ì„œ Mapê³¼ ê°™ì€ ì—°ì‚°ì´ ì¼ì–´ë‚˜ëŠ” ì‹œì ì— í´ëŸ¬ìŠ¤í„°ë¡œ ì‘ì—… ì „ë‹¬
</span>
<span class="n">env</span><span class="p">.</span><span class="n">execute</span><span class="p">()</span>
</code></pre></div></div>

<h1 id="table-api">Table API</h1>

<ul>
  <li>ë°°ì¹˜, ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬ë¥¼ ìœ„í•œ í•„ìš”í•œ ê¸°ëŠ¥ì„ ì œê³µ</li>
  <li>EDA, ETLê³¼ ê°™ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‰½ê²Œ ì •ì˜í•˜ê¸° ìœ„í•´ ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ë¨</li>
  <li>ë°ì´í„°ê°€ ìœ í•œ(Bounded), ë¬´í•œ(Unbounded)í•œ ê²½ìš°ì— ê´€ê³„ì—†ì´ ê°™ì€ ì˜ë¯¸</li>
</ul>

<p><img src="https://nightlies.apache.org/flink/flink-docs-master/docs/dev/python/datastream_tutorial/" alt="ì „ì²´ ì½”ë“œ ì°¸ê³ " target="_blank" /></p>

<h1 id="ì°¸ê³ ">ì°¸ê³ </h1>
<ul>
  <li><a href="https://nightlies.apache.org/flink/flink-docs-master/docs/dev/python/overview/" target="_blank">Apache Flink: pyflink ê³µì‹ë¬¸ì„œ</a></li>
  <li><a href="https://nightlies.apache.org/flink/flink-docs-master/api/python/" target="_blank">Apache Flinkâ€ pyflink Docs ê³µì‹ë¬¸ì„œ</a></li>
</ul>

:ET